@page "/meats/{MeatId:guid}/update"
@inject Client _client;

<h1 class="text-info">Update Meat</h1>

<div class="row">
    <div class="col">
        @if (_meatDto is not null)
        {
            <EditForm Model="_meatDto" OnValidSubmit="Update">
                <DataAnnotationsValidator/>
                <div class="form-group">
                    <label>Meat Name: </label>
                    <div>
                        <InputText class="form-control" @bind-Value="_meatDto.Name"/>
                        <ValidationMessage For="(() => _meatDto.Name)"/>
                    </div>
                </div>
                <label>Meat Price: </label>
                <div>
                    <InputNumber class="form-control" @bind-Value="_meatDto.Price"/>
                    <ValidationMessage For="(() => _meatDto.Price)"/>
                </div>
                <button class="btn btn-outline-primary mt-3">Save</button>
            </EditForm>
        }

        @if (_message is not null)
        {
            <div class="alert alert-success text-center py-2 mt-3">@_message</div>
        }
    </div>
</div>

@code {

    [Parameter]
    public Guid MeatId { get; set; }

    private UpdateMeatDto _meatDto;
    private string _message;

    protected override async Task OnInitializedAsync()
    {
        var meat = await _client.GetMeatByIdAsync(MeatId, "1");
        _meatDto = new UpdateMeatDto
        {
            Name = meat.Name,
            Price = meat.Price
        };
    }

    private async Task Update()
    {
        _message = null;
        await _client.UpdateMeatAsync(MeatId, "1", _meatDto);
        _message = "Editing Success!";
    }

}